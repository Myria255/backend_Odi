<!--pages/Tour/Tour.wxml-->
<nav></nav>
<title_bar label="Informations sur le tour"></title_bar>
<view style="justify-content: center; align-items: center; text-align: center; margin-top: 8%; margin-bottom: 5%;">
    <block wx:if="{{result}}" wx:for="{{result}}" wx:key="id">
        <text style="font-size: 36rpx; font-weight: bold;"> Tour N°{{item.tour[0].numero_tour}}</text>
    </block>
    <view wx:if="{{!result}}">Numéro de tour indisponible</view>
</view>

<!-- <view style="width: 750rpx; height: 323rpx; display: block; box-sizing: border-box"> -->
<view>
    <block wx:if="{{result}}" wx:for="{{result}}" wx:key="id">
        <view style="width: 292rpx; padding: 15rpx; border-radius: 10px; border: 1rpx solid #ff7900; background-color: #F16E00; display: flex; justify-content: center; align-items: center; flex-direction: column; color: white ;" bind:tap="infoTontine">
            <view style="position: relative; left: 17rpx; top: 26rpx; font-size: 35rpx; font-weight: bold;">Nombre de participants ayant cotisé a ce tour:</view>

            <view style="border-radius: 10px;position: relative; width: 95rpx; background: #ED6C30; height: 95rpx; left: 222rpx; top: 25rpx; display: block; box-sizing: border-box; border-radius: 99rpx; margin-left: -6vh">
                <text style="position: relative; left: 23rpx; top: 18rpx; font-size: 30rpx; font-weight: bolder; color: #FFFFFFFF">{{item.tour[0].cotisation.length}}/{{item.nombre_participants}}</text>
            </view>
        </view>

        <view style="position: relative; width: 345rpx; background:#fff; height: 296rpx; display: block; box-sizing: border-box; left: 392rpx; top: -296rpx; font-size: 35rpx; font-weight: bold; box-shadow: 0 3rpx 8rpx rgba(255,121,0,1); border-radius: 18rpx; border-radius: 10px;">
            <text style="position: relative; left: 12rpx; top: 26rpx;font-size: 35rpx; font-weight: bold;">Argent collecté
                pour ce tour:
                {{item.tour[0].montant_distribue}}/{{item.montant_total}} Fcfa
            </text>
        </view>
    </block>
    <block wx:if="{{!result}}">
        <view style="position: relative; width: 345rpx; background: #fff; height: 296rpx; display: block; box-sizing: border-box; left: 32rpx; box-shadow: 0 3rpx 8rpx rgba(255,121,0,1); top: 0rpx ; border-radius: 10px; background-color: rgba(252, 192, 136, 0.445);" bind:tap="infoTontine">
            <view style="position: relative; left: 17rpx; top: 26rpx; font-weight: 500;">Nombre de participants ayant cotisé a ce tour:</view>
            <view style="position: relative; width: 95rpx; background: #ED6C30; height: 95rpx; left: 231rpx; top: 25rpx; display: block; box-sizing: border-box; border-radius: 99rpx">
                <text style="position: relative; left: 43rpx; top: 27rpx; font-size: 30rpx; font-weight: 500; color: #FFFFFFFF">!</text>
            </view>
        </view>

        <view style="position: relative; width: 345rpx; background:#fff; height: 296rpx; display: block; box-sizing: border-box; left: 392rpx; top: -296rpx; font-size: 35rpx; font-weight: bold; box-shadow: 0 3rpx 8rpx rgba(255,121,0,1);border-radius: 10px; background-color: rgb(125, 235, 115);">
            <text style="position: relative; left: 12rpx; top: 26rpx;font-size: 35rpx; font-weight: bold;">Argent collecté
                pour ce tour:
            </text>
            <view style="position: relative; width: 191rpx; height: 65rpx; left: 137rpx; top: 95rpx; display: block; box-sizing: border-box;">Indisponible</view>
        </view>
    </block>
</view>

<view style="width: 710rpx; height: 375rpx; margin-left: 18rpx; display: block; box-sizing: border-box; left: 0rpx; top: 0rpx" class="conteneur contour">
    <block wx:for="{{result}}" wx:key="id">
        <text style="position: relative; left: 0rpx; top: 0rpx" class="h1">Participants</text>
        <scroll-view scroll-y="true" class="scrollarea" style="width: 710rpx; height: 320rpx; display: block; box-sizing: border-box; background-color: #d9d9d960; border-radius: 18rpx;">
            <view style="position: relative; width: 710rpx; height: auto; left: 0rpx; top: 23rpx; display: block; box-sizing: border-box">
                <view data-index="{{index}}" style="width: 710rpx; display: block; box-sizing: border-box">
                    <block wx:for="{{item.participant}}" wx:for-item="participant" wx:for-index="participantIndex" wx:key="id_participant">
                        <block wx:for="{{participant.cotisation}}" wx:for-item="cotisation" wx:key="id_cotisation">
                            <block wx:if="{{cotisation && cotisation.id_tour === item.tour[0].id_tour}}">
                                <view class="listParticipant" style="width: 710rpx; height: 63rpx; display: flex; align-items: center; box-sizing: border-box; border-bottom: 1rpx solid #d9d9d9;">
                                    <view class="index-number" style="width: 50rpx; font-size: 28rpx; color: #333; margin-right: 20rpx;">{{participantIndex + 1}}.</view>
                                    <view class="nom">{{participant.utilisateur.nom}} {{participant.utilisateur.prenoms}}</view>
                                    <view class="montant">{{cotisation.montant_cotise}}</view>
                                </view>
                            </block>
                        </block>
                    </block>
                </view>
            </view>
        </scroll-view>
    </block>
    <block wx:if="{{!result}}">
        <!--  <text style="position: relative; left: 0rpx; top: 0rpx" class="h1">Participants</text>
        <view style="width: 348rpx; height: 39rpx; display: flex; box-sizing: border-box; text-align: center; margin-left: 25%; margin-top: 70px">Pas de données à afficher</view>  -->
    </block>
</view>

<view style="width: 750rpx; height: 323rpx; display: block; box-sizing: border-box">

    <Scroll-view scroll-y="true" class="scrollarea" style="width: 747rpx; height: 271rpx; display: block; box-sizing: border-box">
        <!-- <text style="position: relative; left: 22rpx; top: 0rpx" class="h1">Pénalités</text> -->
        <view style="position: relative; width: 750rpx; background: white; height: 88rpx; left: 0rpx; top: 23rpx; display: block; box-sizing: border-box">
            <block wx:if="{{result}}" wx:for="{{result}}" wx:key="id">
                <view data-index="{{index}}">
                    <!-- <block wx:for="{{item.participant}}" wx:for-item="participant" wx:key="participant.id_participant"> -->
                    <block wx:for="{{item.participant}}" wx:for-item="participant" wx:key="id_participant">
                        <block wx:if="{{participant.penalite && participant.penalite.length>0}}">
                            <text style="position: relative; left: 22rpx; top: 0rpx" class="h1">Pénalités</text>
                            <block wx:for="{{participant.penalite}}" wx:for-item="penalite" wx:key="id_penalite">
                                <view class="listParticipant" style="width: 736rpx; height: 64rpx; display: flex; box-sizing: border-box">
                                    <view class="nom">
                                        {{participant.utilisateur.nom}} {{participant.utilisateur.prenoms}}
                                    </view>
                                    <!-- <block wx:if="{{participant.penalite && participant.penalite.length>0}}">
            <block wx:for="{{participant.penalite}}" wx:for-item="penalite" wx:key="penalite.id_penalite"> -->
                                    <view class="montant">
                                        {{penalite.montant_penalite}}
                                    </view>
                                    <!-- </block>
          </block> -->
                                </view>
                            </block>
                        </block>
                    </block>
                </view>
            </block>
        </view>
        <block wx:if="{{!result}}">
            <!-- <view style="width: 351rpx; height: 49rpx; display: block; box-sizing: border-box; margin-left: 25%; margin-top: 12px">Pas de données à afficher</view> -->
        </block>
    </Scroll-view>
</view>

<view style="width: 730rpx; height: 163rpx; display: block; box-sizing: border-box; margin-left: 10rpx;">
    <block wx:for="{{result}}" wx:key="id">
        <block wx:for="{{item.participant}}" wx:for-item="participant" wx:key="id_participant">
            <view style="position: relative; color: #FF7900; font-size: 36rpx; font-weight: bolder; left: 0rpx; top: 16rpx; width: 696rpx; height: 49rpx; display: block; box-sizing: border-box; margin-left: 22rpx;">Personne qui récupère</view>
            <block wx:if="{{participant.numero_ordre === item.tour[0].numero_tour}}">
                <view style="position: relative; font-size: 31rpx; font-weight: bolder; left: 20rpx; top: 39rpx; width: 688rpx; height: 49rpx; display: block; box-sizing: content-box">{{participant.utilisateur.nom}} {{participant.utilisateur.prenoms}}</view>
            </block>
        </block>
    </block>
    <block wx:if="{{!result}}">
        <!--  <view style="width: 355rpx; height: 49rpx; display: block; box-sizing: border-box; margin-left: 25%; margin-top: 12px">Pas de données à afficher</view> -->
    </block>
</view>